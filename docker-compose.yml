version: "3.7"

services:
  commander:
    container_name: commander-local
    build:
      context: .
      dockerfile: Dockerfile-dev
      args:
        dev_cycle: ${dev_cycle}
    image: love-commander-image-mount
    environment:
      - LSST_DDS_DOMAIN=${LSST_DDS_DOMAIN}
    volumes:
      - .:/usr/src/love
    command: ".setup.sh"
    stdin_open: true
    tty: true

  commander-deploy:
    container_name: commander
    build:
      context: .
      dockerfile: Dockerfile-deploy
      args:
        cycle: ${cycle}
    image: ts-dockerhub.lsst.org/love-commander:${cycle}
